.row#dashboard
  .col-md-6.col-md-offset-3
    %h1 Hi #{current_user.username}, Welcome to your dashboard!

    #tabs-panel{:role => "tabpanel"}
      %ul.nav.nav-pills{:role => "tablist"}
        %li.active{:role => "presentation"}
          %a{"aria-controls" => "home-tab", "data-toggle" => "pill", :href => "#home-tab", :role => "tab"} My Details
        %li{:role => "presentation"}
          %a{"aria-controls" => "settings-tab", "data-toggle" => "pill", :href => "#settings-tab", :role => "tab"} Settings
        %li{:role => "presentation"}
          %a{"aria-controls" => "password-tab", "data-toggle" => "pill", :href => "#password-tab", :role => "tab"} Password
        %li{:role => "presentation"}
          %a{"aria-controls" => "vod-tab", "data-toggle" => "pill", :href => "#vod-tab", :role => "tab"} VoD
        %li{:role => "presentation"}
          %a{"aria-controls" => "stream_key-tab", "data-toggle" => "pill", :href => "#stream_key-tab", :role => "tab"} Stream Key
      .tab-content
        #home-tab.tab-pane.active{:role => 'tabpanel'}
          .panel.panel-default
            .panel-body
              .h3 Your details

              = form_tag({controller: :dashboard, action: :update_user}, {:class => 'form-horizontal'}) do
                .form-group
                  %label.col-sm-2.control-label{:for => "inputUsername"} Username
                  .col-sm-10
                    %input#inputUsername.form-control{type: "text", name: "user[username]", value: current_user.username}
                .form-group
                  %label.col-sm-2.control-label{:for => "inputEmail"} Email
                  .col-sm-10
                    %input#inputEmail.form-control{type: "email", name: "user[email]", value: current_user.email}
                .form-group
                  .col-sm-offset-2.col-sm-10
                    %button.btn.btn-default{:type => "submit"} Update
        #settings-tab.tab-pane{:role => 'tabpanel'}
          .panel.panel-default
            .panel-body
              .h3 Settings

              = form_tag({controller: :dashboard, action: :update_settings}, {:class => 'form-horizontal'}) do
                .form-group
                  %label.col-sm-2.control-label{:for => "inputCanRecord"} VoD active
                  .col-sm-10
                    .checkbox
                      - if current_user.can_record?
                        %input#inputCanRecord{type: "checkbox", name: "user[can_record]", value: 1, checked: 'checked'}
                      - else
                        %input#inputCanRecord{type: "checkbox", name: "user[can_record]", value: 0}
                      %i
                        By clicking here, if you have a
                        %u premium account
                        , all your streams will be recorded as video on demand.
                .form-group
                  .col-sm-offset-2.col-sm-10
                    %button.btn.btn-default{:type => "submit"} Update
        #vod-tab.tab-pane{:role => 'tabpanel'}
          .panel.panel-default
            .panel-body
              .h3 Video on Demand

              - current_user.recordings.each do |recording|
                .media
                  .media-left
                    %a{href: show_vod_path(recording.user.username, recording.id)}
                      = image_tag "https://codewatch-tv.s3-eu-west-1.amazonaws.com/recording-thumbnails/#{recording.name.gsub('.flv', '')}.png", height: 72
                  .media-body
                    %h4.media-heading= recording.title
                    %h5 Created at #{recording.created_at}
                    %p
                      .fa.fa-eye
                        = recording.views
                  .media-right
                    .btn-group
                      %button{type: 'button', class: 'btn btn-default dropdown-toggle', 'data-toggle' => 'dropdown', 'aria-expanded' => 'false'}
                        %span.caret
                      %ul.dropdown-menu{'data-role' => 'menu'}
                        %li
                          = link_to 'Remove', delete_vod_path(recording.id)
                        - if recording.is_visible?
                          %li
                            = link_to 'Hide', toggle_vod_visibility_path(recording.id)
                        -else
                          %li
                            = link_to 'Make visible', toggle_vod_visibility_path(recording.id)
        #password-tab.tab-pane{role: 'tabpanel'}
          .panel.panel-default
            .panel-body
              .h3 Change password

              = form_tag({controller: :dashboard, action: :update_password}, {:class => 'form-horizontal'}) do
                .form-group
                  %label.col-sm-2.control-label{:for => "inputCurrentPassword"} Current Password
                  .col-sm-10
                    %input#inputCurrentPassword.form-control{:type => "password", name: "user[current_password]"}
                .form-group
                  %label.col-sm-2.control-label{:for => "inputNewPassword"} New Password
                  .col-sm-10
                    %input#inputNewPassword.form-control{:type => "password", name: "user[password]"}
                .form-group
                  %label.col-sm-2.control-label{:for => "inputConfirmNewPassword"} Confirm New Password
                  .col-sm-10
                    %input#inputConfirmNewPassword.form-control{:type => "password", name: "user[password_confirmation]"}
                .form-group
                  .col-sm-offset-2.col-sm-10
                    %button.btn.btn-default{:type => "submit"} Change
        #stream_key-tab.tab-pane{:role => "tabpanel"}
          .panel.panel-default
            .panel-body
              .h3 Current Stream Key

              .lead.text-center= "#{current_user.username}?stream_key=#{current_user.stream_key}"



