= render partial: 'shared/breadcrumbs', locals: {page_name: 'Profile'}
.container.content.dashboard
  .row
    .col-md-3.md-margin-bottom-40
      = render partial: 'dashboard/portrait'
      = render partial: 'dashboard/navigation'
    .col-md-9
      .dashboard-body.margin-bottom-20
        .tab-v1
          %ul.nav.nav-justified.nav-tabs
            %li.active
              %a{"data-toggle" => "tab", :href => "#profile-tab"} Edit Profile
            %li
              %a{"data-toggle" => "tab", :href => "#settings-tab"} Settings
            %li
              %a{"data-toggle" => "tab", :href => "#security-tab"} Security
            %li
              %a{"data-toggle" => "tab", :href => "#vod-tab"} VoD
          .tab-content
            #profile-tab.dashboard-edit.tab-pane.fade.in.active
              %h2.heading-md Manage your Name, ID and Email Addresses.
              %p Below are the name and email addresses on file for your account.
              %br
                = form_tag({controller: :dashboard, action: :update_user}, {id: 'sky-form4', class: 'sky-form'}) do
                  %dl.dl-horizontal
                    %dt Username
                    %dd
                      %section
                        %label.input
                          %i.icon-append.fa.fa-user
                          %input{:name => "user[username]", :placeholder => "Username", :type => "text", :value => current_user.username}
                            %b.tooltip.tooltip-bottom-right Needed to enter the website
                    %dt Email address
                    %dd
                      %section
                        %label.input
                          %i.icon-append.fa.fa-envelope
                          %input{:name => "user[email]", :placeholder => "Email address", :type => "text", :value => current_user.email}
                            %b.tooltip.tooltip-bottom-right Needed to verify your account
                    %dt Timezone
                    %dd
                      %section
                        %label.select
                          %select{:name => "user[timezone]"}
                            %option{value: '0', selected: true, disabled: true} Timezone
                            - ActiveSupport::TimeZone.all.each do |tz|
                              %option{value: tz, selected: current_user.timezone == tz.to_s}= tz
                          %i
                  %br
                    %button.btn-u.btn-u-default{:type => "button"} Cancel
                    %button.btn-u{:type => "submit"} Save Changes
            #settings-tab.dashboard-edit.tab-pane.fade
              %h2.heading-md Manage your Account Settings
              %p Bellow you can change your account related settings.
              %br
                = form_tag({controller: :dashboard, action: :update_settings}, {id: 'sky-form3', class: 'sky-form'}) do
                  %label.toggle
                    %input{:checked => current_user.can_record? ? true : false, :name => "user[can_record]", :type => "checkbox"}
                      %i>
                      Video on Demand
                  %hr
                  %br
                    %button.btn-u.btn-u-default{:type => "button"} Cancel
                    %button.btn-u{:type => "submit"} Save Changes
            #security-tab.dashboard-edit.tab-pane.fade
              %h2.heading-md Manage your Security Settings
              %p Bellow you can change your security related settings.
              %br
                = form_tag({controller: :dashboard, action: :update_user}, {id: 'sky-form4', class: 'sky-form'}) do
                  %dl.dl-horizontal
                    %dt Current Password
                    %dd
                      %section
                        %label.input
                          %i.icon-append.fa.fa-lock
                          %input{:name => "user[current_password]", :type => "password", placeholder: 'Your old password here'}
                    %dt New Password
                    %dd
                      %section
                        %label.input
                          %i.icon-append.fa.fa-lock
                          %input{:name => "user[password]", :type => "password", placeholder: 'Your new password here'}
                    %dt Confirm New Password
                    %dd
                      %section
                        %label.input
                          %i.icon-append.fa.fa-lock
                          %input{:name => "user[password_confirmation]", :type => "password", placeholder: 'Confirm your new one, just to be sure :)'}
                  %br
                    %button.btn-u.btn-u-default{:type => "button"} Cancel
                    %button.btn-u{:type => "submit"} Save Changes
            / End Checkout-Form
            #vod-tab.dashboard-edit.tab-pane.fade
              %h2.heading-md Manage your Video on Demand.
              %p Bellow you can manage your videos on demand.
              %br
                - current_user.recordings.order_by(created_at: :desc).each do |recording|
                  .media
                    .media-left
                      %a{href: show_vod_path(recording.user.username, recording.id)}
                        = image_tag "https://codewatch-tv.s3-eu-west-1.amazonaws.com/recording-thumbnails/#{recording.name.gsub('.flv', '')}.png", height: 72
                    .media-body
                      %h4.media-heading= recording.title
                      %h5 Created at #{recording.created_at}
                      %p
                        %i.fa.fa-eye
                          = recording.views
                    .media-right
                      = link_to toggle_vod_visibility_path(recording.id), class: 'margin-bottom-5' do
                        - if recording.is_visible?
                          %i.fa.fa-eye-slash &nbsp;Hide
                        - else
                          %i.fa.fa-eye &nbsp;Show
                      = link_to delete_vod_path(recording.id) do
                        %i.fa.fa-trash &nbsp;Delete
